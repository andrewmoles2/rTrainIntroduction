---
title: "R Workshop 4 - Data Frames part 2"
author:
   - name: Andrew Moles
     affiliation: Learning Developer, Digital Skills Lab
date: "`r format(Sys.time(), '%d %B, %Y')`"
output: 
  html_document: 
    theme: readable
    highlight: pygments
    keep_md: yes
---

# What will this workshop cover?

In this workshop, the aim is to cover how to load and work with data frames, as well as an introduction to packages. We will be covering:

*  Introduction to packages
*  Introduction to directories and projects
*  Loading in data
*  Exporting data

# Information on how the session is run

One hour exercise based session with tutor support. You will be given example code for a problem, then given a related exercise to complete.

## Why this style?

*  Online training is tiring so keeping the sessions to one hour
*  No or limited demonstrations provided in order to provide more real world experience - you have a problem and you look up how to solve it, adapting example code
*  Trainer support to guide through process of learning

## We will be working in pairs:

*  Option to work together on worksheet or to work individually
*  If possible have your camera on and introduce yourself to each other

## What to do when getting stuck:

1)  Ask your team members
2)  Search online:
  *  The answer box on the top of Google's results page 
  *  stackoverflow.com (for task-specific solutions)
  *  https://www.r-bloggers.com/ (topic based tutorials)
3)  Don't struggle too long looking online, ask the trainer if you can't find a solution!

***

# Introduction to packages

Packages are collections of functions, code, and sample data put together by the R community. Packages are one of the main benefits of R. As R is open source there can be lots of contributors who have made functions to do complex tasks, such as data cleaning, specific types of data analysis, or exciting data visualisation.

To install these packages onto your computer you have to download them from CRAN (The Comprehensive R Archive Network). 

![](https://github.com/andrewmoles2/rTrainIntroduction/blob/master/Workshop4a/images/CRAN.png?raw=true){width=30%}

There are two ways of doing this, using code (recommended and easiest) or using the menus (Tools > Install Packages). 

Using code involves using the install packages function, which looks like: `install.packages("package name")`. To install the package you would type something like:`install.packages("readr")`.

Once installed, you will not need to do this again unless you install a newer version of R. 

## Installing packages task

Try installing the following packages:`readr`, `readxl`, `writexl`, and `here` using the `install.packages()` function. We will be using these in today's session. 

```{r}
# your code here

```

## Loading packages

Now you have installed the packages, you need to load them so you can use them. **Each time you load R you will need to re-load the packages you want to use**. 

To load a package you need to use the `library()` function. For example, if I wanted to load the `readr` package I would type `library(readr)`.

## Loading packages task

Using `library()` load in the packages you just installed: `readr`, `readxl`, `writexl`, and `here`.

```{r}
# your code here

```

If you are not sure what packages are loaded, you can use `sessionInfo()`. Run the code below to test it out. Under *other attached packages* you should see readr, readxl, writexl, and here. 
```{r}
sessionInfo()
```

# Introduction to directories

A directory is a file path on your computer, known as the working directory. It tells R where to find files to load or save files out of R. Directories work in a top down hierarchical manner. 

To find out where your working directory is in R you can use `getwd()`. 

Run the code below, the output should be the file your rWorkshop4b.Rmd is saved in. 
```{r}
getwd()
```

# Introduction to RStudio Projects

A project is a centralised place to keep all your files for a study, piece of work, or 'project'. When you start a new Project it sets up a working directory in a fresh R session. Because the project sets up the working directory and keeps all your project related files in one place, it makes managing your files and analysis much easier, and helps you to share your code with collaborators or supervisors. 

*note: you can also change your working directory using the setwd() function, but in the long run it can be difficult to manage. E.g. if a file moves or gets deleted* 

## How to set up a project? 

1) File > New Project...
2) Select new directory (or existing directory if you have already set up a file)

*New directory*  

1) Select new project
2) Give your directory a name, e.g. "rWorkshop"
3) Select browse and find the directory you want to start your project
4) Press Create Project
5) Your new project should open

*Existing directory*

1) Select browse and find the directory you want to start your project
2) Press Create Project
3) Your new project should open

To open and review your projects in future you will see them in a drop down menu in the top right corner of RStudio. 

## Project task

1) Set up a project for this workshop using the steps above. 
2) Go to your newly created project folder in either File Explorer (Windows) or Finder (Mac). 
3) Put your rWorkshop4b.Rmd file in your project directory (if you have not do so already).
4) Add a new file called data, and add in the data files for the session (). 
5) You should see the changes reflected in your file explorer (bottom right in RStudio). 
6) In the code chunk below run `getwd()`. You should get your new project file system as the output. 

```{r}
# your code here

```

# Loading in data from your computer

Data can be loaded into R either from files from your computer, or the internet using URLs. R can handle many different file types thanks to packages built by the R community. These include .csv, .xlsx, .sav, .dta. 

To check your data files are where you expect them to be, you can use the `list.files()` function. 
```{r}
list.files()
```


You should see your rworkshop4b.Rmd and your data file. We can direct this to the data file where our data is now saved using the here package. If you are not sure if your data file is in the same directory as this notebook run the below command to list the files in your directory. *note: you will likely have to change the file names to the names of your files, e.g. Workshop4b*.  

`list.files(here("datafolder", "datafile"))`

*not working for me, they just need to put in data*
```{r}
library(here)
list.files(here("Workshop4b", "data"))
```
This command should print out: *pokemonGen1.csv*, *pokemonGen1.xlsx*, *pokemonGen2.csv*, *pokemongen2.xlsx*.

We can also call packages using the package name and two colons (::), see example below:
```{r}
list.files(here::here("Workshop4b", "data"))
```


We are going to load in a .csv file and a .xlsx file, two of the most common file types to be loaded into R. 

**hint: an RStudio shortcut to find files is to press tab when the cursor is in the speech marks ("")**
```{r}

```

## Loading data task

# Using the here package

Short intro to here, example, and task. 

Here is good for many reasons, it can build a file path that is not dependent on the operating system you are using. For example, file paths in Mac use forward slashes (/) and Windows use backward slashes (\). This is great for using your code across different systems, and for sharing your code.

```{r}
# example using here to write a file
```


## Here package task

Subset a data frame, then write the csv using here
```{r}

```



# Loading in data from the internet

For example, every Tuesday an open source data set is released on GitHub via https://github.com/rfordatascience/tidytuesday. I can scroll down to the datasets section, pick a data set I'm interested in, go to the 'get the data here' section, and follow the first line as shown below.
```{r}
passwords <- readr::read_csv('https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2020/2020-01-14/passwords.csv')
```

The general rule is if there is a file you can download, you can get the url from that download and load it into R. You do this by right clicking on the data file I want and selecting *'copy link address'*. I then paste that into the speech marks in my `read.csv()` function. 

## Loading data from a url task

To to the tidyverse page and download the IKEA data set - https://github.com/rfordatascience/tidytuesday/blob/master/data/2020/2020-11-03/readme.md

*hint: in the get data here section, follow the read in data manually section*

```{r}
# your code here

```


# Exporting data

# Other options for loading data

It is useful to mention the `data.table` package, which is very good at loading large csv files with its `fread()` function. 

A typical project folder will have several sub-folders such as code (for scripts), data (for your data files), and outputs (for your figures). 

Run the code below to see an example data science file system. Projects are usually at the analysis stage (blue boxes). 
```{r message=FALSE}
knitr::include_graphics(here::here("Workshop4b","images", "fileSys.png"))
```

# Final task - Please give us your individual feedback!

This is the first time that we are exploring a remote learning format for our workshops and we would be grateful if you could take 2 mins before the end of the workshop to get your feedback!

https://lse.eu.qualtrics.com/jfe/form/SV_9zagWkOtzNhmqt7?course=D025-R1NV&topic=R&cohort=MT20

# Individual take home challenge 

```{r}
# Load in data from url > do a bit of indexing > make a new col etc. 
```


